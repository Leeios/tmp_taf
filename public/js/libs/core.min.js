sand.define("core/Array/collect",function(){Array.prototype.collect=function(a){var b=[];if(typeof a=="string")for(var c=-1,d=this.length;++c<d;)b.push(this[c][a]);else for(var c=-1,d=this.length;++c<d;)b.push(a(this[c]));return b}}),sand.define("core/Array/compact",function(){Array.prototype.compact=function(){for(var a=this.length;a--;)this[a]||this.splice(a,1);return this}}),sand.define("core/Array/diff",["core/Array/has"],function(){Array.prototype.diff=function(a){var b={add:[],rem:[]};for(var c=this.length;c--;)a.has(this[c])||b.rem.push(this[c]);for(c=a.length;c--;)this.has(a[c])||b.add.push(a[c]);return b}}),sand.define("core/Array/each",function(){Array.prototype.each=function(a){for(var b=0,c=this.length;b<c;b++)a(this[b],b,this);return this}}),sand.define("core/Array/except",function(){Array.prototype.except=function(a){var b=[];for(var c=0,d=this.length;c<d;c++)this[c]!==a&&b.push(this[c]);return b}}),sand.define("core/Array/exceptFn",function(){Array.prototype.exceptFn=function(a){var b=this.slice();for(var c=b.length;c--;)a(b[c])&&b.splice(c,1);return b}}),sand.define("core/Array/exec",function(){Array.prototype.exec=function(a){if(typeof a=="function")for(var b=this.length;b--;)f(this[b]);else{a=a.substr(2,a.length);for(var b=this.length;b--;)this[b][a]()}}}),sand.define("core/Array/find",function(){Array.prototype.find=function(a){for(var b=0,c=this.length;b<c;b++)if(a(this[b]))return this[b]}}),sand.define("core/Array/first",function(){Array.prototype.first=function(a){for(var b=0,c=this.length;b<c;b++)if(a(this[b]))return this[b];return null}}),sand.define("core/Array/flatten",function(a){Array.prototype.flatten=function(a){var b=[];if(typeof a!="number")for(var c=-1,d=this.length;++c<d;)Array.isArray(this[c])?b=b.concat(this[c].flatten()):b.push(this[c]);else for(var c=-1,d=this.length;++c<d;)Array.isArray(this[c])&&a?b=b.concat(this[c].flatten(a-1)):b.push(this[c]);return b}}),sand.define("core/Array/has",function(){Array.prototype.has=function(a){for(var b=this.length;b--;)if(this[b]===a)return!0;return!1}}),sand.define("core/Array/include",function(){Array.prototype.include=function(a){for(var b=this.length;b--;)if(this[b]===a)return!0;return!1}}),sand.define("core/Array/includedIn",function(){Array.prototype.includedIn=function(a){for(var b=-1,c=this.length;++b<c;)if(!a.include(this[b]))return!1;return!0}}),sand.define("core/Array/indexesOf",function(){Array.prototype.indexesOf=function(a){var b,c=this.concat(),d=0,e=[];while((b=c.indexOf(a))!==-1)e.push(b+d),c=c.splice(b,b),d++;return e}}),sand.define("core/Array/last",function(){Array.prototype.last=function(){return this[this.length-1]}}),sand.define("core/Array/map",function(){var a=this.debug;Array.prototype.map=function(b,c){c&&(b=b.bind(c));var d=this.slice();if(typeof b=="function")for(var e=0,f=d.length;e<f;e++)d[e]=b(d[e],e);else{a.i&&console.log("should not happen?"),b=b.substr(2,b.length);for(var e=0,f=d.length;e<f;e++)d[e]=d[e][b]()}return d},Array.prototype.as=function(b){return a.w&&console.log("[WARNING]: deprecated, use map instead of as"),Array.prototype.map.call(this,b)}}),sand.define("core/Array/mapAsync",["core/Array/curry"],function(a){Array.prototype.mapAsync=function(a,b){var c=this.length,d=c,e=[],f=!1,g=function(b,c,g){if(f)return;c&&(f=!0,typeof c=="object"&&typeof c.index=="undefined"&&(c.index=b),a(c)),e[b]=g,!--d&&a(null,e)};for(var h=0;h<c;h++)b(g.curry(h),this[h])}}),sand.define("core/Array/max",function(){Array.prototype.max=function(){var a=this.length;if(a){var b=this[0];for(var c=1;c<a;c++)this[c]>b&&(b=this[c]);return b}return null}}),sand.define("core/Array/min",function(){Array.prototype.min=function(){var a=this[0];for(var b=1;b<this.length;b++)this[b]<a&&(a=this[b]);return a}}),sand.define("core/Array/move",function(){Array.prototype.move=function(a,b){return this.splice(b,0,this.splice(a,1)[0]),this}}),sand.define("core/Array/eachB",function(){return Array.prototype.eachB=function(a){for(var b=-1,c=this.length;++b<c;)if(a(this[b])===!1)return this[b];return null}}),sand.define("core/Array/onEls",function(){Array.prototype.onEls=function(a){for(var b=this.length;b--;)this[b]=a(this[b]);return this}}),sand.define("core/Array/one",function(){Array.prototype.one=function(a,b){if(typeof a=="function"){for(var c=-1,d=this.length;++c<d;)if(a(this[c]))return this[c]}else{b||(b=!0);for(var c=-1,d=this.length;++c<d;)if(this[c][a]===b)return this[c]}return null}}),sand.define("core/Array/remove",function(){Array.prototype.remove=function(a){for(var b=this.length;b--;)this[b]===a&&this.splice(b,1);return this}}),sand.define("core/Array/removeOneValue",function(){Array.prototype.removeOneValue=function(a){for(var b=this.length;b--;)if(this[b]===a)return this.splice(b,1)}}),sand.define("core/Array/replace",function(){Array.prototype.replace=function(a,b){for(var c=this.length;c--;)this[c]===a&&(this[c]=b);return this}}),sand.define("core/Array/send",function(){Array.prototype.send=function(a){var b=Array.prototype.slice.call(arguments);b.splice(0,1);if(typeof a=="string")for(var c=-1,d=this.length;++c<d;)this[c][a].apply(this[c],b);else for(var c=-1,d=this.length;++c<d;)a.apply({},[this[c]].concat(b));return this}}),sand.define("core/Array/set",function(){Array.prototype.set=function(a,b){for(var c=-1,d=this.length;++c<d;)this[c][a]=b;return this}}),sand.define("core/Array/substract",function(){Array.prototype.substract=function(a){var b=this.slice();for(var c=a.length;c--;)b.remove(a[c]);return b}}),sand.define("core/Array/uniq",["core/Array/has"],function(){Array.prototype.uniq=function(a){var b=[];if(!a)for(var c=-1,d=this.length;++c<d;)!b.has(this[c])&&b.push(this[c]);else if(typeof a=="string"){var e=[];for(var c=-1,d=this.length;++c<d;){var f=this[c][a];e.has(f)||(b.push(this[c]),e.push(f))}}else{var e=[];for(var c=0,d=this.length;c<d;c++){var f=a(this[c]);e.has(f)||(b.push(this[c]),e.push(f))}}return b}}),sand.define("core/Array/where",function(){Array.prototype.where=function(a,b){var c=[];if(typeof a=="function")for(var d=-1,e=this.length;++d<e;)a(this[d],d)&&c.push(this[d]);else{typeof b=="undefined"&&(b=!0);for(var d=-1,e=this.length;++d<e;)this[d][a]===b&&c.push(this[d])}return c}}),sand.define("core/Function/bind",function(){Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}}),Function.prototype.for=function(a){for(var b=a.length;b--;)if(!this(a[b]))return!1;return!0}}),sand.define("core/Function/bindThis",function(){Function.prototype.bindThis=function(a){return this._b=!0,this}}),sand.define("core/Function/curry",function(){Function.prototype.curry=function(){var a=this,b=Array.prototype.slice.call(arguments);return function(){var c=Array.prototype.slice.call(arguments);return a.apply(this,b.concat(c))}}}),sand.define("core/Function/exec",function(){Function.prototype.exec=function(a){return this._e=!0,this}}),sand.define("core/Function/lurry",function(){Function.prototype.lurry=function(){var a=this,b=Array.prototype.slice.call(arguments);return function(){var c=Array.prototype.slice.call(arguments);return a.apply(this,c.concat(b))}}}),sand.define("core/String/as",function(){String.prototype.as=function(a){return a(this)}}),sand.define("core/String/bindThis",["core/Function/bindThis"],function(){var a=this.debug;String.prototype.bindThis=function(){var a=this;return function(){this[a].apply(this,arguments)}.bindThis()}}),sand.define("core/String/capitalize",function(){String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}}),sand.define("core/String/exec",["core/Function/exec"],function(){var a=this.debug,b=[{symbol:"+",fn:function(a,b){var c=a.exec()(this),d=b.exec()(this);return isNaN(parseInt(c))||isNaN(parseInt(d))?c+d:parseInt(c)+parseInt(d)}},{symbol:"-",fn:function(a,b){var c=a.exec()(this),d=b.exec()(this);return isNaN(parseInt(c))||isNaN(parseInt(d))?c+"-"+d:parseInt(c)-parseInt(d)}},{symbol:".",fn:function(a,b){var c=this[a];return b.exec()(c)}}];String.prototype.exec=function(){var a=this.toString();return function(c){var d=c||this;for(var e=0,f=b.length;e<f;e++)for(var g=0,h=a.length;g<h;g++)if(b[e].symbol===a[g])return b[e].fn.call(d||this,a.substr(0,g),a.substr(g+1));var i=isNaN(parseInt(a))?a:parseInt(a);return d.length&&typeof d=="object"?d[i]:typeof d[i]=="function"?d[i].bind(d)():d[i]||a.toString()}.exec()}}),sand.define("core/String/indexesOf",function(){String.prototype.indexesOf=function(a){var b,c=this.concat(),d=0,e=[];while((b=c.indexOf(a))!==-1)e.push(b+d),c=c.substr(0,b)+c.substr(b+1,c.length-b-1),d++;return e}}),sand.define("core/String/isBlank",function(){String.prototype.isBlank=function(){return/^[ ]*$/.test(this)}}),sand.define("core/String/pluralize",function(){String.prototype.pluralize=function(){return this+"s"}}),sand.define("core/String/safe",function(){String.prototype.safe=function(){return this.replace(/</g,"&lt;").replace(/>/g,"&gt;")}}),sand.define("core/String/shrink",function(){String.prototype.shrink=function(a){return this.length<a?this:this.slice(0,a-7)+"..."+this.slice(this.length-3,this.length)}}),sand.define("core/String/singularize",function(){String.prototype.singularize=function(){return this.substr(0,this.length-1)}}),sand.define("core/String/uncapitalize",function(){String.prototype.uncapitalize=function(){return this[0].toLowerCase()+this.substr(1,this.length-1)}}),sand.define("core/String/unsafe",function(){String.prototype.unsafe=function(){return this.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/\n/g,"<br />").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<")}}),sand.define("core/as",function(){return function(a,b){return b(a)}}),sand.define("core/clone",function(){return function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}}),sand.define("core/empty",function(){this.exports=function(a){var b=[],c={};for(var d in c)c.hasOwnProperty(d)&&b.push(d);for(d in a)if(a.hasOwnProperty(d)&&!b.has(d))return!1;return!0}}),sand.define("core/extend",function(){return function(a){a.prototype&&(a=a.prototype);for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b].prototype||arguments[b];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}}),sand.define("core/AsyncStack",function(){var a=function(a){this._fs=[],this.cb=a};a.prototype={add:function(a){this._fs.push(a)},process:function(){this._fs.length?this._fs.shift()(function(){this.process()}.bind(this)):this.cb()}},this.exports=a}),sand.define("core/arrayify",function(){this.exports=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}}),sand.define("core/close",function(){this.exports=function(a,b){var c=a;return Core.helpers.isArray(c)||(c=[c]),function(){return b.apply({},c.concat(Array.prototype.slice.call(arguments)))}}}),sand.define("core/deepSmoothExtend",["core/isArray"],function(a,b,c){var d=function(a,b){for(var e in b)b.hasOwnProperty(e)&&(typeof a[e]=="object"&&!c(a[e])?d(a[e],b[e]):a[e]=b[e]);return a};return d}),sand.define("core/each",function(){return function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c);return a}}),sand.define("core/extend",function(){return function(a){a.prototype&&(a=a.prototype);for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b].prototype||arguments[b];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}}),sand.define("core/isArray",function(){this.exports=function(a){return typeof a=="object"&&a&&a.constructor.toString().indexOf("Array")!==-1}}),sand.define("core/merge",function(){this.exports=function(a,b){var c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c}}),sand.define("core/send",["core/each"],function(a,b,c){return function(a,b){var d=Array.prototype.slice.call(arguments);return d.shift(),d.shift(),typeof b=="string"?c(a,function(a){a[b].apply(a,d)}):c(a,function(a){b.apply(a,d)}),a}}),sand.define("core/values",function(){return function(a){var b=[];for(var c in a)b.push(a[c]);return b}}),sand.define("core/hardClone",["core/isArray"],function(a){return function(b){if(typeof b!="object")return b;if(!a.isArray(b)){var c={};for(var d in b)if(b.hasOwnProperty(d)){var e=typeof b[d];e==="string"||e==="number"||e==="boolean"||b[d]===null?c[d]=b[d]:c[d]=arguments.callee(b[d])}return c}var f=[];for(var d=b.length;d--;){var e=typeof b[d];e==="string"||e==="number"||e==="boolean"||b[d]===null?f[d]=b[d]:f[d]=arguments.callee(b[d])}return f}}),sand.define("core/hardCloneProperties",["core/hardClone"],function(a){var b=a.hardClone;return function(a,c){var d={};for(var e in a)a.hasOwnProperty(e)&&(d[e]=b(c[e]));return d}}),sand.define("core/isArray",function(){return function(a){return typeof a=="object"&&a&&a.constructor.toString().indexOf("Array")!==-1}}),sand.define("core/keys",function(){return function(a){var b=[];for(var c in a)b.push(c);return b}}),sand.define("core/params",function(){var a={},b=/(\?|&)([^=]*)=([^&$#]*)/g,c;while(c=b.exec(window.location.href))a[c[2]]=c[3];return a}),sand.define("core/RegExp/match",function(){RegExp.prototype.match=function(a){var b=[],c;while((c=this.exec(a))!==null)b.push(c);return b}}),sand.define("core/protos/string",["core/extend"],function(a){var b=a,c=b.extend;c(String.prototype,{safe:function(){return this.replace(/</g,"&lt;").replace(/>/g,"&gt;")},pluralize:function(){return this+"s"},uncapitalize:function(){return this[0].toLowerCase()+this.substr(1,this.length-1)},isBlank:function(){/^[ ]*$/.test(this)},capitalize:function(){return this.charAt(0).toUpperCase()+this.slice(1)},multiply:function(a){var b="";while(a--)b+=this;return b},isColor:function(){var a=function(a){a=a.substr(1,6);for(var b=6;b--;){b=b.toUpperCase();if(b!=="1"&&b!=="2"&&b!=="3"&&b!=="4"&&b!=="5"&&b!=="6"&&b!=="7"&&b!=="8"&&b!=="9"&&b!=="A"&&b!=="B"&&b!=="C"&&b!=="D"&&b!=="E"&&b!=="F")return!1}return!0};return this.length===7&&this[0]==="#"&&a(this)},rgbToHex:function(){var a,b;return b=/rgb\(\ ?([0-9]+)\ ?,\ ?([0-9]+)\ ?,\ ?([0-9]+)\ ?\)/,(a=this.match(b))&&a.shift()&&"#"+a.collect(function(a){var b=parseInt(a).toString(16);return b[1]||(b="0"+b),b}).join("")},toNumber:function(){var a=parseInt(this);return this.length===a.toString().length&&a},singularize:function(){return this.substr(0,this.length-1)},splice:function(a,b,c){return this.slice(0,a)+c+this.slice(a+Math.abs(b))}})}),sand.define("core/setDot",function(){return function(a,b,c){b=b.split(".");for(var d=-1,e=b.length;++d<e;)console.log(a,b[d]),a=a[b[d]];a=c}}),sand.define("core/toArray",function(){return function(a){var b=[];for(var c in a)b.push(a[c]);return b}}),sand.define("core/treeValue",function(){this.exports=function(a,b){var c=a.split("."),d=b;for(var e=0,f=c.length;e<f;e++){var g=c[e].charAt(c[e].length-1);if(g===")"){var h=c[e].substr(0,c[e].indexOf("("));d=d[h]()}else if(g==="]"){var i=c[e].substr(0,c[e].indexOf("["));d=d[h]}else d=d[c[e]];if(!d)break}return d||null}})
